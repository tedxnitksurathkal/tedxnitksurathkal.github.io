<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ========== Meta Tags ========== -->
  <meta charset="UTF-8" />
  <meta name="description" content="TEDx NITKSurathkal" />
  <meta name="keywords" content="TED, TEDx, TEDxNITKSurathkal, TEDx NITK, NITK, NITK Surathkal" />
  <meta name="author" content="TEDx NITK Surathkal" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="TEDxNITKSurathkal | Ideas Worth Spreading" />
  <meta property="og:title" content="TEDxNITKSurathkal | Ideas Worth Spreading" />
  <meta property="og:description"
    content="TEDxNITKSurathkal is coming back for Edition 2021! See you on 20th February 2021." />
  <meta property="og:url" content="http://www.tedxnitksurathkal.in/" />
  <meta property="og:image" content="http://www.tedxnitksurathkal.in/assets/img/favicon.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />

  <!-- ========== Title ========== -->
  <title>Connect the Dots | TEDxNITKSurathkal</title>

  <!-- ========== Favicon Ico ========== -->
  <link rel="icon" href="assets/img/favicon.png" />

  <!-- ========== STYLESHEETS ========== -->
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

  <!--- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

  <!-- 2022 Theme -->
  <link rel="stylesheet" href="./assets/theme/css/style.css">
</head>

<body>
  <div class="modal" tabindex="-1" id="start-modal">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">INSTRUCTIONS</h2>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>1. Connect the dots and draw anything in 1 minute</p>
          <p>2. If you are done before the timer is over, click the
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="feather feather-check-circle">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg> button
          </p>
          <p>3. ENJOY ðŸŽ‰</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="start-btn">Start</button>
        </div>
      </div>
    </div>
  </div>

  <div class="container text-center" id="theme-reveal" style="display: none;">
    <img src="assets/img/theme/connect-the-dots-title.png" style="padding: 50px 0;">
    <div id="hidden-svg"></div>
    <button id="vivus-anim" class="home-btn">Replay Animation</button>
    <button id="download-btn" class="home-btn">Download drawing</button>
    <div class="pt-3">
      <p>Our lives are a collection of colourful, distinct moments. Pieces that may or may not hold significance on
        their own, but when put together to compose a beautiful tapestry, reveal more than just the sum of its parts.
        These moments, these numerous dots in our lives, tend to have something of a butterfly effect, compounding and
        moulding the bigger picture, the final product, us.</p>
      <p>Drawing from the famous quote by Steve Jobs, the way these dots connect isn't apparent while looking forward,
        but only discernible when looking back, when we take the time to see ourselves as fascinating beings made up of
        so many stories of our own. </p>
      <p>TEDxNITKSurathkal presents <strong>Connect the dots</strong>, an experience that promises to help us see our
        wonderfully complex and unique story. Join us as our speakers through their talks and performances showcase the
        wondrous tapestry of their experiences and knowledge, helping us paint our own masterpiece.
      </p>
      <a href="/" class="home-btn">Home</a>
      <a href="/theme" class="home-btn">Play Again</a>
    </div>
    <img src="assets/img/tedx-white.png" height="80px;" style="margin-top: 20px;">
  </div>

  <div class="app"></div>

  <!-- ========== SCRIPTS ========== -->
  <!-- Bootstrap and jQuery CDN -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/vivus@0.4.6/dist/vivus.min.js"></script>
  <!-- 2022 Theme -->
  <script src="./assets/theme/main.js" type="module"></script>
  <!-- GTAG Script -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-110715968-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-110715968-3');

    let vivusAnim;
    let startModal = new bootstrap.Modal(document.getElementById('start-modal'));
    let downloadAnchor = document.createElement('a');
    downloadAnchor.style.display = 'none';

    $(window).on('load', function () {
      $('.loader').delay(100).fadeOut('slow');
      startModal.show();
      document.body.appendChild(downloadAnchor);
    });

    document.getElementById('start-modal').addEventListener('hide.bs.modal', e => {
      startTimer();
    })

    function startTimer() {
      let timer = document.querySelector('project-page').shadowRoot.querySelector('toolbar-cmp').shadowRoot.querySelector('.timer')

      function updateTimer() {
        let time = timer.innerHTML.split(':')
        let minutes = parseInt(time[0])
        let seconds = parseInt(time[1])
        if (minutes == 0 && seconds == 0) {
          clearInterval(interval)
          revealTheme();
          return
        }
        seconds -= 1
        if (seconds == -1) {
          minutes -= 1
          seconds = 59
        }
        if (seconds < 10) {
          seconds = '0' + seconds
        }
        timer.innerHTML = minutes + ':' + seconds
      }

      let interval = setInterval(updateTimer, 1000);
    }


    function revealTheme() {
      document.querySelector('.app').style.display = 'none';
      document.querySelector('#theme-reveal').style.display = 'block'
      document.getElementById('hidden-svg').innerHTML = extractSVG().outerHTML
      vivusAnim = new Vivus('svg-surface')
      document.getElementById('vivus-anim').addEventListener('click', () => {
        vivusAnim.reset().play()
      })
      document.getElementById('download-btn').addEventListener('click', downloadSVG)
    }

    function buildPNG() {
      vivusAnim?.finish();
      const svg = document.querySelector('#hidden-svg svg').cloneNode(true);
      svg.setAttribute('width', 3000)
      svg.setAttribute('height', 3000)
      const canvas = document.createElement('canvas');
      canvas.width = parseInt(svg.getAttribute('width') || '0', 10);
      canvas.height = parseInt(svg.getAttribute('height') || '0', 10);
      const ctx = canvas.getContext("2d");
      ctx.fillStyle = '#000';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      const blob = new Blob([svg.outerHTML], { type: 'image/svg+xml' });
      const url = window.URL.createObjectURL(blob);
      return new Promise((res, rej) => {
        const baseimage = new Image();
        baseimage.style.background = '#000';
        baseimage.onload = function () {
          ctx.drawImage(baseimage, 1, 1, canvas.width, canvas.height);
          canvas.toBlob((blob) => {
            const file = new File([blob], 'minimator.png', { type: 'image/png' });
            res(file);
          });
        };
        baseimage.onerror = rej;
        baseimage.src = url;
      });
    }

    function downloadSVG() {
      buildPNG().then(file => {
        downloadAnchor.href = URL.createObjectURL(file);
        downloadAnchor.download = 'drawing.png';
        downloadAnchor.click();
      })
    }

    function extractSVG(margin = 2, scaleTo) {
      let _a, _b;
      const newDotId = 'dot-' + btoa(`${Math.random() * (Math.pow(2, 53))}`);
      document.querySelector('project-page').shadowRoot.querySelector('surface-cmp').shadowRoot.querySelector('svg > rect').style.display = 'inherit'
      const svg = document.querySelector('project-page').shadowRoot.querySelector('surface-cmp').shadowRoot.querySelector('svg').cloneNode(true);

      svg.setAttribute('width', 300);
      svg.setAttribute('height', 300);
      svg.setAttribute('viewBox', '-2 -2 300 300');
      (_a = svg.querySelector(`pattern`)) === null || _a === void 0 ? void 0 : _a.setAttribute('id', newDotId);
      (_b = svg.querySelector(`[data-ref="dots"]`)) === null || _b === void 0 ? void 0 : _b.setAttribute('fill', `url('#${newDotId}')`);
      return svg;
    }
  </script>
</body>

</html>